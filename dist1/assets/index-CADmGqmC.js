import{J as l,a1 as _,a2 as P,a3 as S,a4 as U,S as B,L as i,R as z,O as A,n as s,E as p,Z as E,a5 as L,F as N,Y as O,a6 as C,U as v,V,H as F,W as x}from"./index-DORryCv9.js";import{a as T}from"./alarmService-H8aFSQOA.js";import{a as R}from"./alarmLogService-Cf8XBdbD.js";import{_ as W}from"./ConfirmDialog-C6xDu_gO.js";import{V as j}from"./VDataTableServer-CR2qsNjt.js";import"./VPagination-CV1TbuMH.js";const H={class:"d-flex align-center ga-3 mb-2"},J={class:"text-caption text-grey d-flex align-center"},M={class:"d-flex justify-end ga-1"},X={__name:"index",setup(Y){const r=l(!1),g=l([]),f=l(0),o=l(1),m=l(15),b=l([]),D=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],d=l(""),w=[{title:"No",key:"no",sortable:!1,width:100},{title:"알람 ID",key:"alarmId",sortable:!1,width:150},{title:"DID ID",key:"didId",sortable:!1,width:150},{title:"설명",key:"alarmDesc",sortable:!1},{title:"조치내역",key:"alarmRepairDesc",sortable:!1,width:300},{title:"발생시간",key:"alarmDate",sortable:!1},{title:"내역 수정",key:"actions",sortable:!1,width:110,align:"center"}];async function n(){r.value=!0;try{const e=await R.getPageCurrentAlarmLog({page:o.value-1,size:m.value,alarmId:u.value||null,didId:d.value||null});g.value=(e==null?void 0:e.content)??(e==null?void 0:e.items)??(e==null?void 0:e.list)??[],f.value=(e==null?void 0:e.totalElements)??(e==null?void 0:e.total)??0}finally{r.value=!1}}_(()=>{r.value||n()},5e3,{immediate:!0});function I(e){o.value=e.page,m.value=e.itemsPerPage,b.value=e.sortBy??[],n()}P(()=>{n(),k()});const u=l(null),y=l([]),k=async()=>{try{const e=await T.getAllAlarms();y.value=e??[]}catch(e){showError(e.message)}};S(u,()=>n()),U(d,()=>{o.value=1,n()},{debounce:350,maxWait:1200});const h=l(!1);return(e,t)=>(A(),B(z,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:i(()=>[s(W,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),message:"선택한 알람을 삭제하시겠습니까?"},null,8,["modelValue"]),p("div",H,[s(E,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=a=>u.value=a),items:y.value,"item-title":"alarmDesc","item-value":"alarmId",density:"compact",variant:"outlined","hide-details":"",clearable:"",placeholder:"알람 선택",style:{"max-width":"260px"}},{item:i(({props:a,item:c})=>[s(L,N(a,{subtitle:c.raw.alarmId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"]),s(O,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),density:"compact",variant:"outlined","hide-details":"",placeholder:"알람 ID 검색",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),s(C),p("div",J,[s(V,{icon:"mdi-clock-outline",size:"14",class:"mr-1"}),t[3]||(t[3]=v(" 현재 시각을 기준으로 최근 24시간 이내의 데이터를 5초 주기로 조회합니다. ",-1))])]),s(j,{headers:w,items:g.value,"items-length":f.value,loading:r.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":m.value,page:o.value,"onUpdate:options":I,"items-per-page-options":D,class:"alarm-table"},{"item.no":i(({index:a})=>[v(x((o.value-1)*m.value+a+1),1)]),"item.alarmDesc":i(({item:a})=>{var c;return[v(x((c=a.alarm)==null?void 0:c.alarmDesc),1)]}),"item.actions":i(({item:a})=>[p("div",M,[s(F,{icon:"",variant:"text",size:"x-small"},{default:i(()=>[s(V,{icon:"mdi-pencil"})]),_:1})])]),"no-data":i(()=>[...t[4]||(t[4]=[p("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{X as default};
