import{ay as R,a as O,J as u,a7 as M,a3 as Q,a2 as W,S as $,O as B,L as l,n as t,R as G,aU as Y,E as d,W as r,H as h,V as Z,U as V,aV as X,P as ee,K as ae,T as le,Q as b,Y as K,Z as N,a5 as C,F as A,aW as te,a6 as q,az as E,a4 as se,ae as D,aA as F,aB as J}from"./index-DORryCv9.js";import{V as oe,_ as ie}from"./ConfirmDialog-C6xDu_gO.js";import{g as ne}from"./gameService-D0PrTKSi.js";import{g as de}from"./groupService-PkHVRCNi.js";import{c as ue}from"./casinoService-BONeBPR8.js";import{s as L}from"./Toast-AsRXutAQ.js";import{V as re}from"./VForm-DX2byA9X.js";import{V as ce}from"./VDataTableServer-CR2qsNjt.js";import"./VPagination-CV1TbuMH.js";const pe={async getAllJpSize(){const{data:x}=await R.get("/api/v1/jp-size/all");return x}},me={async getAllJpType(){const{data:x}=await R.get("/api/v1/jp-type/all");return x}},ve={key:0,class:"text-red text-caption"},fe={__name:"JackpotSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(x,{emit:z}){const g=x,w=z,m=O({get:()=>g.modelValue,set:e=>w("update:modelValue",e)}),v=O(()=>!!g.editItem),_=u(null),P=u(!1),I={idxNo:null,jackpotId:"",groupId:null,casinoId:null,mwId:null,gameId:null,minPrize:0,maxPrize:0,typeId:null,sizeId:null,delaySec:0},s=M({...I});function y(){var e,o;Object.assign(s,I),(o=(e=_.value)==null?void 0:e.resetValidation)==null||o.call(e)}function T(e){var o,i;s.idxNo=(e==null?void 0:e.idxNo)??null,s.jackpotId=(e==null?void 0:e.jackpotId)??"",s.groupId=(e==null?void 0:e.groupId)??null,s.casinoId=(e==null?void 0:e.casinoId)??null,s.mwId=(e==null?void 0:e.mwId)??null,s.gameId=(e==null?void 0:e.gameId)??null,s.minPrize=(e==null?void 0:e.minPrize)??0,s.maxPrize=(e==null?void 0:e.maxPrize)??0,s.typeId=(e==null?void 0:e.typeId)??null,s.sizeId=(e==null?void 0:e.sizeId)??null,s.delaySec=(e==null?void 0:e.delaySec)??0,(i=(o=_.value)==null?void 0:o.resetValidation)==null||i.call(o)}const k=()=>{m.value=!1};Q(()=>m.value,e=>{if(!e){y();return}g.editItem?T(g.editItem):y()});const U=async()=>{var i;const{valid:e}=await((i=_.value)==null?void 0:i.validate());!e||!await j()||(w("save"),k())},j=async()=>{try{return P.value=!0,v.value?await E.updateJackpot(s.idxNo,s):await E.saveJackpot(s),!0}catch(e){return L((e==null?void 0:e.message)||"잭팟정보 변경에 실패했습니다."),!1}finally{P.value=!1}};W(()=>H());const n=u([]),p=u([]),a=u([]),c=u([]),f=u([]),H=async()=>{try{n.value=await de.getAllGroupInfos(),p.value=await ue.getAllCasinos(),a.value=await ne.getAllGames(),c.value=await me.getAllJpType(),f.value=await pe.getAllJpSize()}catch(e){return L((e==null?void 0:e.message)||"초기정보 로드에 실패했습니다."),!1}};return(e,o)=>(B(),$(oe,{modelValue:m.value,"onUpdate:modelValue":o[6]||(o[6]=i=>m.value=i),persistent:"","max-width":"450"},{default:l(()=>[t(G,null,{default:l(()=>[t(Y,{class:"d-flex justify-space-between align-center"},{default:l(()=>[d("span",null,r(v.value?"잭팟 수정":"잭팟 등록"),1),t(h,{icon:"",variant:"text",onClick:k},{default:l(()=>[t(Z,null,{default:l(()=>[...o[7]||(o[7]=[V("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),t(X,{class:"pt-0"},{default:l(()=>[t(re,{ref_key:"form",ref:_},{default:l(()=>[t(ee,{dense:""},{default:l(()=>[v.value?le("",!0):(B(),ae("span",ve,"* 잭팟 ID 는 등록 후 수정이 불가능 합니다.")),t(b,{cols:"12"},{default:l(()=>[t(K,{modelValue:s.jackpotId,"onUpdate:modelValue":o[0]||(o[0]=i=>s.jackpotId=i),label:"잭팟 ID",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(b,{cols:"12"},{default:l(()=>[t(N,{modelValue:s.groupId,"onUpdate:modelValue":o[1]||(o[1]=i=>s.groupId=i),items:n.value,"item-title":"groupName","item-value":"groupId",label:"그룹",variant:"outlined",density:"compact"},{item:l(({props:i,item:S})=>[t(C,A(i,{subtitle:S.raw.groupId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),t(b,{cols:"12"},{default:l(()=>[t(N,{modelValue:s.casinoId,"onUpdate:modelValue":o[2]||(o[2]=i=>s.casinoId=i),items:p.value,"item-title":"casinoName","item-value":"casinoId",label:"카지노",variant:"outlined",density:"compact"},{item:l(({props:i,item:S})=>[t(C,A(i,{subtitle:S.raw.casinoId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),t(b,{cols:"12"},{default:l(()=>[t(N,{modelValue:s.gameId,"onUpdate:modelValue":o[3]||(o[3]=i=>s.gameId=i),items:a.value,"item-title":"gameName","item-value":"gameId",label:"게임",variant:"outlined",density:"compact",rules:[e.requiredRule]},{item:l(({props:i,item:S})=>[t(C,A(i,{subtitle:S.raw.gameId}),null,16,["subtitle"])]),_:1},8,["modelValue","items","rules"])]),_:1}),t(b,{cols:"12"},{default:l(()=>[t(N,{modelValue:s.typeId,"onUpdate:modelValue":o[4]||(o[4]=i=>s.typeId=i),items:c.value,"item-title":"typeName","item-value":"typeId",label:"종류",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(b,{cols:"12"},{default:l(()=>[t(N,{modelValue:s.sizeId,"onUpdate:modelValue":o[5]||(o[5]=i=>s.sizeId=i),items:f.value,"item-title":"sizeName","item-value":"sizeId",label:"사이즈",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(te,null,{default:l(()=>[t(q),t(h,{color:"error",onClick:k},{default:l(()=>[...o[8]||(o[8]=[V("취소",-1)])]),_:1}),t(h,{color:"primary",loading:P.value,onClick:U},{default:l(()=>[V(r(v.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ge={class:"d-flex align-center ga-3 mb-2"},Ie={class:"d-flex flex-column"},ye={class:"text-caption"},Ve={class:"text-micro"},xe={class:"d-flex flex-column"},_e={class:"text-caption"},ke={class:"text-micro"},be={class:"d-flex flex-column"},ze={class:"text-caption"},we={class:"text-micro"},Pe={class:"d-flex flex-column text-caption"},Se={class:"d-flex"},Ne={class:"d-flex"},De={class:"d-flex flex-column text-caption"},je={class:"d-flex"},Te={class:"d-flex"},Le={__name:"index",setup(x){const z=u(!1),g=u([]),w=u(0),m=u(1),v=u(13),_=u([]),P=[{title:"13",value:13},{title:"30",value:30},{title:"50",value:50}],I=u(""),s=[{title:"No",key:"no",sortable:!1,width:60},{title:"잭팟 ID",key:"jackpotId",sortable:!1},{title:"카지노",key:"casinoId",sortable:!1},{title:"그룹",key:"groupId",sortable:!1},{title:"게임",key:"gameId",sortable:!1},{title:"종류",key:"typeId",sortable:!1},{title:"사이즈",key:"sizeId",sortable:!1},{title:"미들웨어 ID",key:"mwId",sortable:!1},{title:"적립금액",key:"prizeCurrency",sortable:!1},{title:"최소금액",key:"minPrize",sortable:!1},{title:"최대금액",key:"maxPrize",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}];async function y(){z.value=!0;try{const n=await E.getPageJackPotInfos({page:m.value-1,size:v.value,keyword:I.value});g.value=(n==null?void 0:n.content)??(n==null?void 0:n.items)??(n==null?void 0:n.list)??[],w.value=(n==null?void 0:n.totalElements)??(n==null?void 0:n.total)??0}finally{z.value=!1}}function T(n){m.value=n.page,v.value=n.itemsPerPage,_.value=n.sortBy??[],y()}W(()=>{y()}),se(I,()=>{m.value=1,y()},{debounce:350,maxWait:1200});const k=u(!1),U=u(null),j=u(!1);return(n,p)=>(B(),$(G,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:l(()=>[t(fe,{modelValue:k.value,"onUpdate:modelValue":p[0]||(p[0]=a=>k.value=a),"edit-item":U.value,onSave:y},null,8,["modelValue","edit-item"]),t(ie,{modelValue:j.value,"onUpdate:modelValue":p[1]||(p[1]=a=>j.value=a),message:"선택한 잭팟을 삭제하시겠습니까?"},null,8,["modelValue"]),d("div",ge,[t(K,{modelValue:I.value,"onUpdate:modelValue":p[2]||(p[2]=a=>I.value=a),density:"compact",variant:"outlined","hide-details":"",placeholder:"잭팟 ID 검색",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),t(q)]),t(ce,{headers:s,items:g.value,"items-length":w.value,loading:z.value,"item-value":"idxNo",density:"compact","fixed-header":"",height:"560","items-per-page":v.value,page:m.value,"onUpdate:options":T,"items-per-page-options":P,class:"alarm-table"},{"item.no":l(({index:a})=>[V(r((m.value-1)*v.value+a+1),1)]),"item.casinoId":l(({item:a})=>{var c,f;return[d("div",Ie,[d("div",ye,r((c=a.casino)==null?void 0:c.casinoName),1),d("div",Ve,"ID: "+r((f=a.casino)==null?void 0:f.casinoId),1)])]}),"item.groupId":l(({item:a})=>{var c,f;return[d("div",xe,[d("div",_e,r((c=a.group)==null?void 0:c.groupName),1),d("div",ke,"ID: "+r((f=a.group)==null?void 0:f.groupId),1)])]}),"item.gameId":l(({item:a})=>{var c;return[d("div",be,[d("div",ze,r((c=a.game)==null?void 0:c.gameName),1),d("div",we,"ID: "+r(a.gameId),1)])]}),"item.sizeId":l(({item:a})=>{var c;return[d("div",Pe,[d("div",Se,r((c=a.jpSize)==null?void 0:c.sizeName),1),d("div",Ne,r(a.jpType.typeName),1)])]}),"item.prizeCurrency":l(({item:a})=>[V(r(D(J)(a.prizeCurrency))+" 원 ",1)]),"item.minPrize":l(({item:a})=>[V(r(D(J)(a.minPrize))+" 원 ",1)]),"item.maxPrize":l(({item:a})=>[V(r(D(J)(a.maxPrize))+" 원 ",1)]),"item.upTime":l(({item:a})=>[d("div",De,[d("div",je,r(D(F)(a.upTime).date),1),d("div",Te,r(D(F)(a.upTime).time),1)])]),"item.actions":l(({item:a})=>[...p[3]||(p[3]=[d("div",{class:"d-flex justify-end ga-1"},null,-1)])]),"no-data":l(()=>[...p[4]||(p[4]=[d("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{Le as default};
