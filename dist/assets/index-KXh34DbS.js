import{a as E,J as u,a7 as F,a3 as Y,S as B,O as U,L as o,n as t,R as G,aU as z,E as I,W as b,H as _,V as O,U as c,aV as $,P as j,K as A,T as L,Q as P,Y as C,aW as W,a6 as R,a2 as M,a4 as H,aR as J,ae as S}from"./index-RVKrnBr_.js";import{g as N}from"./groupService-Cjmgqr7G.js";import{V as K,_ as Q}from"./ConfirmDialog-Bbju44CG.js";import{s as q}from"./Toast-Zaq-uJvg.js";import{V as X}from"./VForm-Du5tOv7Y.js";import{g as T}from"./uiMeta-B6m7eSIp.js";import{V as Z}from"./VDataTableServer-BOncxrIG.js";import"./VPagination-O_hIR4q6.js";const ee={key:0,class:"text-red text-caption"},ae={__name:"GroupSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(h,{emit:v}){const r=h,f=v,n=E({get:()=>r.modelValue,set:e=>f("update:modelValue",e)}),i=E(()=>!!r.editItem),p=u(null),g=u(!1),s=F({...{groupId:null,groupName:""}}),m=()=>{var e,a;s.groupId=null,s.groupName="",(a=(e=p.value)==null?void 0:e.resetValidation)==null||a.call(e)},k=e=>{var a,l;s.groupId=(e==null?void 0:e.groupId)??null,s.groupName=(e==null?void 0:e.groupName)??"",(l=(a=p.value)==null?void 0:a.resetValidation)==null||l.call(a)},d=()=>{n.value=!1};Y(()=>n.value,e=>{if(!e){m();return}r.editItem?k(r.editItem):m()});const y=async()=>{var l;const{valid:e}=await((l=p.value)==null?void 0:l.validate());!e||!await w()||(f("save"),d())},w=async()=>{try{return g.value=!0,i.value?await N.updateGroup(s):await N.saveGroup(s),!0}catch(e){return q((e==null?void 0:e.message)||"그룹정보 변경에 실패했습니다."),!1}finally{g.value=!1}},D=[e=>!!e||"그룹 ID는 필수입니다.",e=>(e==null?void 0:e.length)<=10||"그룹 ID는 최대 10자까지 입력 가능합니다."],x=[e=>(e==null?void 0:e.length)<=30||"그룹 이름은 최대 30자까지 입력 가능합니다."];return(e,a)=>(U(),B(K,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=l=>n.value=l),persistent:"","max-width":"450"},{default:o(()=>[t(G,null,{default:o(()=>[t(z,{class:"d-flex justify-space-between align-center"},{default:o(()=>[I("span",null,b(i.value?"그룹 수정":"그룹 등록"),1),t(_,{icon:"",variant:"text",onClick:d},{default:o(()=>[t(O,null,{default:o(()=>[...a[3]||(a[3]=[c("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),t($,{class:"pt-0"},{default:o(()=>[t(X,{ref_key:"form",ref:p},{default:o(()=>[t(j,{dense:""},{default:o(()=>[i.value?L("",!0):(U(),A("span",ee,"* 그룹 ID 는 등록 후 수정이 불가능 합니다.")),t(P,{cols:"12"},{default:o(()=>[t(C,{modelValue:s.groupId,"onUpdate:modelValue":a[0]||(a[0]=l=>s.groupId=l),label:"그룹 ID",variant:"outlined",density:"compact",disabled:i.value,rules:D},null,8,["modelValue","disabled"])]),_:1}),t(P,{cols:"12"},{default:o(()=>[t(C,{modelValue:s.groupName,"onUpdate:modelValue":a[1]||(a[1]=l=>s.groupName=l),label:"그룹 이름",variant:"outlined",density:"compact",rules:x},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(W,null,{default:o(()=>[t(R),t(_,{color:"error",onClick:d},{default:o(()=>[...a[4]||(a[4]=[c("취소",-1)])]),_:1}),t(_,{color:"primary",loading:g.value,onClick:y},{default:o(()=>[c(b(i.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},le={class:"d-flex align-center ga-3 mb-2"},te={class:"d-flex justify-end ga-1"},ce={__name:"index",setup(h){const v=u(!1),r=u([]),f=u(0),n=u(1),i=u(15),p=u([]),g=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],V=u(""),s=[{title:"No",key:"no",sortable:!1,width:100},{title:"그룹 ID",key:"groupId",sortable:!1,width:300},{title:"그룹 이름",key:"groupName",sortable:!1},{title:"사용여부",key:"useYn",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}],m=async()=>{v.value=!0;try{const e=await N.getPageGroupInfos({page:n.value-1,size:i.value,keyword:V.value||""});r.value=(e==null?void 0:e.content)??(e==null?void 0:e.items)??(e==null?void 0:e.list)??[],f.value=(e==null?void 0:e.totalElements)??(e==null?void 0:e.total)??0}finally{v.value=!1}},k=e=>{n.value=e.page,i.value=e.itemsPerPage,p.value=e.sortBy??[],m()};M(()=>{m()}),H(V,()=>{n.value=1,m()},{debounce:350,maxWait:1200});const d=u(!1),y=u(null),w=e=>{y.value={...e},d.value=!0},D=()=>{y.value=null,d.value=!0},x=u(!1);return(e,a)=>(U(),B(G,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:o(()=>[t(ae,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=l=>d.value=l),"edit-item":y.value,onSave:m},null,8,["modelValue","edit-item"]),t(Q,{modelValue:x.value,"onUpdate:modelValue":a[1]||(a[1]=l=>x.value=l),message:"선택한 그룹을 삭제하시겠습니까?"},null,8,["modelValue"]),I("div",le,[t(C,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=l=>V.value=l),density:"compact",variant:"outlined","hide-details":"",placeholder:"그룹 검색 (ID, 이름)",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),t(R),t(_,{variant:"outlined",onClick:D,class:"bg-gold"},{default:o(()=>[...a[3]||(a[3]=[c(" 그룹 등록 ",-1)])]),_:1})]),t(Z,{headers:s,items:r.value,"items-length":f.value,loading:v.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":i.value,page:n.value,"onUpdate:options":k,"items-per-page-options":g,class:"alarm-table"},{"item.no":o(({index:l})=>[c(b((n.value-1)*i.value+l+1),1)]),"item.useYn":o(({item:l})=>[t(J,{size:"small",variant:"flat",color:S(T)(l.useYn).color,class:"font-weight-medium"},{default:o(()=>[c(b(S(T)(l.useYn).text),1)]),_:2},1032,["color"])]),"item.actions":o(({item:l})=>[I("div",te,[t(_,{icon:"",variant:"text",size:"x-small",onClick:oe=>w(l)},{default:o(()=>[t(O,{icon:"mdi-pencil"})]),_:1},8,["onClick"])])]),"no-data":o(()=>[...a[4]||(a[4]=[I("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{ce as default};
