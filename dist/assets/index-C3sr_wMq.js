import{ay as O,a as j,J as n,a7 as G,a3 as X,a2 as K,S as Q,O as z,L as d,n as l,R as Z,aU as ee,E as P,W as C,H as U,V as h,U as y,aV as le,P as ae,K as te,T as de,Q as m,Y as S,Z as _,a5 as B,F as Y,aW as oe,a6 as q,a4 as se,aR as L,ae as A}from"./index-RVKrnBr_.js";import{i as ie}from"./iconService-BMPLZoRO.js";import{s as ne}from"./screenClientService-x2_9XfZO.js";import{e as ue}from"./emapService-D4DGzkBO.js";import{s as W}from"./Toast-Zaq-uJvg.js";import{V as re}from"./VForm-Du5tOv7Y.js";import{V as ce,_ as pe}from"./ConfirmDialog-Bbju44CG.js";import{g as H,a as J}from"./uiMeta-B6m7eSIp.js";import{V as me}from"./VDataTableServer-BOncxrIG.js";import"./VPagination-O_hIR4q6.js";const F={async getPageDidInfos({page:v=0,size:c=24,keyword:p=null}={}){const{data:V}=await O.get("/api/v1/did/info/page",{params:{page:v,size:c,keyword:p}});return V},async saveDid(v){await O.post("/api/v1/did",v)},async updateDid(v,c){await O.put(`/api/v1/did/${v}`,c)}},ve={key:0,class:"text-red text-caption"},Ie={__name:"DidSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(v,{emit:c}){const p=v,V=c,r=j({get:()=>p.modelValue,set:e=>V("update:modelValue",e)}),g=n([{title:"DID_PC",value:"1"},{title:"DISPLAY_PC",value:"2"},{title:"WebOS",value:"3"}]),I=j(()=>!!p.editItem),b=n(null),f=n(!1),N={idxNo:null,didId:"",didType:null,didName:"",didDesc:"",didIpAddr:"",eMapId:null,eMapAxis:"",clientId:null,didIconId:null,didStatusIconId:null},a=G({...N});function T(){var e,t;Object.assign(a,N),(t=(e=b.value)==null?void 0:e.resetValidation)==null||t.call(e)}function x(e){var t,o;a.idxNo=(e==null?void 0:e.idxNo)??null,a.didId=(e==null?void 0:e.didId)??"",a.didType=(e==null?void 0:e.didType)??null,a.didName=(e==null?void 0:e.didName)??"",a.didDesc=(e==null?void 0:e.didDesc)??"",a.didIpAddr=(e==null?void 0:e.didIpAddr)??"",a.eMapId=(e==null?void 0:e.emapId)??null,a.eMapAxis=(e==null?void 0:e.eMapAxis)??"",a.clientId=(e==null?void 0:e.clientId)??null,a.didIconId=(e==null?void 0:e.didIconId)??null,a.didStatusIconId=(e==null?void 0:e.didStatusIconId)??null,(o=(t=b.value)==null?void 0:t.resetValidation)==null||o.call(t)}const D=()=>{r.value=!1};X(()=>r.value,e=>{if(!e){T();return}p.editItem?x(p.editItem):T()});const E=async()=>{var o;const{valid:e}=await((o=b.value)==null?void 0:o.validate());!e||!await M()||(V("save"),D())},M=async()=>{try{return f.value=!0,I.value?await F.updateDid(a.idxNo,a):await F.saveDid(a),!0}catch(e){return W((e==null?void 0:e.message)||"DID정보 변경에 실패했습니다."),!1}finally{f.value=!1}};K(()=>i());const w=n([]),s=n([]),u=n([]),i=async()=>{try{w.value=await ie.getAllIcons(),s.value=await ue.getAllEmapInfos(),u.value=await ne.getAllScreenClients()}catch(e){return W((e==null?void 0:e.message)||"초기정보 로드에 실패했습니다."),!1}},R=[e=>!!e||"DID ID는 필수입니다.",e=>(e==null?void 0:e.length)<=10||"DID ID는 최대 10자까지 입력 가능합니다."],$=[e=>(e==null?void 0:e.length)<=50||"DID 설명은 최대 50자까지 입력 가능합니다."];return(e,t)=>(z(),Q(ce,{modelValue:r.value,"onUpdate:modelValue":t[9]||(t[9]=o=>r.value=o),persistent:"","max-width":"450"},{default:d(()=>[l(Z,null,{default:d(()=>[l(ee,{class:"d-flex justify-space-between align-center"},{default:d(()=>[P("span",null,C(I.value?"DID 수정":"DID 등록"),1),l(U,{icon:"",variant:"text",onClick:D},{default:d(()=>[l(h,null,{default:d(()=>[...t[10]||(t[10]=[y("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),l(le,{class:"pt-0"},{default:d(()=>[l(re,{ref_key:"form",ref:b},{default:d(()=>[l(ae,{dense:""},{default:d(()=>[I.value?de("",!0):(z(),te("span",ve,"* DID ID 는 등록 후 수정이 불가능 합니다.")),l(m,{cols:"12"},{default:d(()=>[l(S,{modelValue:a.didId,"onUpdate:modelValue":t[0]||(t[0]=o=>a.didId=o),label:"DID ID",variant:"outlined",density:"compact",rules:R,disabled:I.value},null,8,["modelValue","disabled"])]),_:1}),l(m,{cols:"12"},{default:d(()=>[l(S,{modelValue:a.didName,"onUpdate:modelValue":t[1]||(t[1]=o=>a.didName=o),label:"DID 이름",variant:"outlined",density:"compact",disabled:I.value},null,8,["modelValue","disabled"])]),_:1}),l(m,{cols:"12"},{default:d(()=>[l(_,{modelValue:a.eMapId,"onUpdate:modelValue":t[2]||(t[2]=o=>a.eMapId=o),items:s.value,"item-title":"emapName","item-value":"emapId",label:"E-MAP",variant:"outlined",density:"compact"},{item:d(({props:o,item:k})=>[l(B,Y(o,{subtitle:k.raw.emapId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),l(m,{cols:"12"},{default:d(()=>[l(_,{modelValue:a.clientId,"onUpdate:modelValue":t[3]||(t[3]=o=>a.clientId=o),items:u.value,"item-title":"clientId","item-value":"clientId",label:"스크린 클라이언트 ID",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"6"},{default:d(()=>[l(_,{modelValue:a.didType,"onUpdate:modelValue":t[4]||(t[4]=o=>a.didType=o),items:g.value,"item-title":"title","item-value":"value",label:"종류",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"6"},{default:d(()=>[l(S,{modelValue:a.didIpAddr,"onUpdate:modelValue":t[5]||(t[5]=o=>a.didIpAddr=o),label:"DID IP",variant:"outlined",density:"compact",rules:$},null,8,["modelValue"])]),_:1}),l(m,{cols:"6"},{default:d(()=>[l(_,{modelValue:a.didIconId,"onUpdate:modelValue":t[6]||(t[6]=o=>a.didIconId=o),items:w.value,"item-title":"iconName","item-value":"iconId",label:"아이콘",variant:"outlined",density:"compact"},{item:d(({props:o,item:k})=>[l(B,Y(o,{subtitle:k.raw.iconId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),l(m,{cols:"6"},{default:d(()=>[l(_,{modelValue:a.didStatusIconId,"onUpdate:modelValue":t[7]||(t[7]=o=>a.didStatusIconId=o),items:w.value,"item-title":"iconName","item-value":"iconId",label:"상태 아이콘",variant:"outlined",density:"compact"},{item:d(({props:o,item:k})=>[l(B,Y(o,{subtitle:k.raw.iconId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),l(m,{cols:"12"},{default:d(()=>[l(S,{modelValue:a.didDesc,"onUpdate:modelValue":t[8]||(t[8]=o=>a.didDesc=o),label:"DID 설명",variant:"outlined",density:"compact",rules:$},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(oe,null,{default:d(()=>[l(q),l(U,{color:"error",onClick:D},{default:d(()=>[...t[11]||(t[11]=[y("취소",-1)])]),_:1}),l(U,{color:"primary",loading:f.value,onClick:E},{default:d(()=>[y(C(I.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},fe={class:"d-flex align-center ga-3 mb-2"},Ve={class:"d-flex justify-end ga-1"},Ue={__name:"index",setup(v){const c=n(!1),p=n([]),V=n(0),r=n(1),g=n(15),I=n([]),b=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],f=n(""),N=[{title:"No",key:"no",sortable:!1,width:100},{title:"DID ID",key:"didId",sortable:!1},{title:"종류",key:"didType",sortable:!1},{title:"이름",key:"didName",sortable:!1},{title:"IP",key:"didIpAddr",sortable:!1},{title:"E-Map ID",key:"emapId",sortable:!1},{title:"클라이언트 ID",key:"clientId",sortable:!1},{title:"ICON",key:"didIconId",sortable:!1},{title:"사용여부",key:"useYn",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}];async function a(){c.value=!0;try{const s=await F.getPageDidInfos({page:r.value-1,size:g.value,keyword:f.value});p.value=(s==null?void 0:s.content)??(s==null?void 0:s.items)??(s==null?void 0:s.list)??[],V.value=(s==null?void 0:s.totalElements)??(s==null?void 0:s.total)??0}finally{c.value=!1}}function T(s){r.value=s.page,g.value=s.itemsPerPage,I.value=s.sortBy??[],a()}K(()=>{a()}),se(f,()=>{r.value=1,a()},{debounce:350,maxWait:1200});const x=n(!1),D=n(null);function E(s){D.value={...s},x.value=!0}function M(){D.value=null,x.value=!0}const w=n(!1);return(s,u)=>(z(),Q(Z,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:d(()=>[l(Ie,{modelValue:x.value,"onUpdate:modelValue":u[0]||(u[0]=i=>x.value=i),"edit-item":D.value,onSave:a},null,8,["modelValue","edit-item"]),l(pe,{modelValue:w.value,"onUpdate:modelValue":u[1]||(u[1]=i=>w.value=i),message:"선택한 Did를 삭제하시겠습니까?"},null,8,["modelValue"]),P("div",fe,[l(S,{modelValue:f.value,"onUpdate:modelValue":u[2]||(u[2]=i=>f.value=i),density:"compact",variant:"outlined","hide-details":"",placeholder:"Did 검색 (ID, 이름)",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),l(q),l(U,{variant:"outlined",onClick:M,class:"bg-gold"},{default:d(()=>[...u[3]||(u[3]=[y(" Did 등록 ",-1)])]),_:1})]),l(me,{headers:N,items:p.value,"items-length":V.value,loading:c.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":g.value,page:r.value,"onUpdate:options":T,"items-per-page-options":b,class:"alarm-table"},{"item.no":d(({index:i})=>[y(C((r.value-1)*g.value+i+1),1)]),"item.didType":d(({item:i})=>[l(L,{size:"small",variant:"flat",color:A(J)(i.didType).color,class:"font-weight-medium"},{default:d(()=>[y(C(A(J)(i.didType).text),1)]),_:2},1032,["color"])]),"item.useYn":d(({item:i})=>[l(L,{size:"small",variant:"flat",color:A(H)(i.useYn).color,class:"font-weight-medium"},{default:d(()=>[y(C(A(H)(i.useYn).text),1)]),_:2},1032,["color"])]),"item.actions":d(({item:i})=>[P("div",Ve,[l(U,{icon:"",variant:"text",size:"x-small",onClick:R=>E(i)},{default:d(()=>[l(h,{icon:"mdi-pencil"})]),_:1},8,["onClick"])])]),"no-data":d(()=>[...u[4]||(u[4]=[P("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{Ue as default};
