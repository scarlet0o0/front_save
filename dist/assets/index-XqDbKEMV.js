import{ay as E,a as F,J as u,a7 as K,a3 as Q,a2 as R,S as A,O as T,L as s,n as l,R as W,aU as X,E as V,W as U,H as N,V as D,U as x,aV as Y,P as Z,K as q,T as G,$ as ee,Q as i,Y as f,aX as B,Z as $,a5 as le,F as ae,aW as te,a6 as H,a4 as oe,aR as se,ae as M}from"./index-RVKrnBr_.js";import{V as de,_ as ne}from"./ConfirmDialog-Bbju44CG.js";import{c as ue}from"./casinoService-DDBjtioA.js";import{s as j}from"./Toast-Zaq-uJvg.js";import{V as ie}from"./VForm-Du5tOv7Y.js";import{b as O}from"./uiMeta-B6m7eSIp.js";import{V as re}from"./VDataTableServer-BOncxrIG.js";import"./VPagination-O_hIR4q6.js";const z={async getPageMemberInfos({page:y=0,size:b=24,keyword:p}={}){const{data:g}=await E.get("/api/v1/member/info/page",{params:{page:y,size:b,keyword:p}});return g},async saveMember(y){await E.post("/api/v1/member",y)},async updateMember(y){await E.put("/api/v1/member",y)}},ce={__name:"UserSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(y,{emit:b}){const p=y,g=b,v=F({get:()=>p.modelValue,set:e=>g("update:modelValue",e)}),r=F(()=>!!p.editItem),C=u(null),P=u(!1),m=u(!1),w=u(!1),k=u([{title:"최고 관리자",value:"1"},{title:"관리자",value:"2"},{title:"일반사용자",value:"3"}]),h={userId:"",userPw:"",userPwCheck:"",userLevel:null,userName:"",casinoId:null,employeeId:"",officeCode01:"",officeCode02:"",officeCode03:"",officeCode04:"",tel01:"",tel02:""},o=K({...h}),I=()=>{var e,a;Object.assign(o,{...h}),(a=(e=C.value)==null?void 0:e.resetValidation)==null||a.call(e)},S=e=>{var a,t;Object.assign(o,{userId:(e==null?void 0:e.userId)??"",userPw:(e==null?void 0:e.userPw)??"",userPwCheck:(e==null?void 0:e.userPwCheck)??"",userLevel:(e==null?void 0:e.userLevel)??"",userName:(e==null?void 0:e.userName)??"",casinoId:(e==null?void 0:e.casinoId)??null,employeeId:(e==null?void 0:e.employeeId)??"",userLevel:(e==null?void 0:e.userLevel)??null,officeCode01:(e==null?void 0:e.officeCode01)??"",officeCode02:(e==null?void 0:e.officeCode02)??"",officeCode03:(e==null?void 0:e.officeCode03)??"",officeCode04:(e==null?void 0:e.officeCode04)??"",tel01:(e==null?void 0:e.tel01)??"",tel02:(e==null?void 0:e.tel02)??""}),(t=(a=C.value)==null?void 0:a.resetValidation)==null||t.call(a)},L=()=>{v.value=!1};Q(()=>v.value,e=>{if(!e){I();return}p.editItem?S(p.editItem):I()});const _=u([]),d=async()=>{try{const e=await ue.getAllCasinos();_.value=e}catch(e){j(e.message||"카지노 조회에 실패했습니다.")}};R(()=>d());const c=async()=>{var t;const{valid:e}=await((t=C.value)==null?void 0:t.validate());!e||!await n()||(g("save"),L())},n=async()=>{try{return P.value=!0,r.value?await z.updateMember(o):await z.saveMember(o),!0}catch(e){return j((e==null?void 0:e.message)||"사용자정보 변경에 실패했습니다."),!1}finally{P.value=!1}};return(e,a)=>(T(),A(de,{modelValue:v.value,"onUpdate:modelValue":a[15]||(a[15]=t=>v.value=t),persistent:"","max-width":"450"},{default:s(()=>[l(W,null,{default:s(()=>[l(X,{class:"d-flex justify-space-between align-center"},{default:s(()=>[V("span",null,U(r.value?"사용자 수정":"사용자 등록"),1),l(N,{icon:"",variant:"text",onClick:L},{default:s(()=>[l(D,null,{default:s(()=>[...a[16]||(a[16]=[x("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),l(Y,{class:"pt-0"},{default:s(()=>[l(ie,{ref_key:"form",ref:C},{default:s(()=>[l(Z,{dense:""},{default:s(()=>[r.value?G("",!0):(T(),q(ee,{key:0},[l(i,{cols:"12"},{default:s(()=>[l(f,{modelValue:o.userId,"onUpdate:modelValue":a[0]||(a[0]=t=>o.userId=t),label:"사용자 ID",variant:"outlined",density:"compact","hide-details":"",disabled:r.value},null,8,["modelValue","disabled"])]),_:1}),l(i,{cols:"12"},{default:s(()=>[l(f,{modelValue:o.userPw,"onUpdate:modelValue":a[1]||(a[1]=t=>o.userPw=t),type:m.value?"text":"password",label:"사용자 비밀번호",variant:"outlined",density:"compact","hide-details":"",disabled:r.value,"append-inner-icon":m.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":a[2]||(a[2]=t=>m.value=!m.value)},null,8,["modelValue","type","disabled","append-inner-icon"])]),_:1}),l(i,{cols:"12"},{default:s(()=>[l(f,{modelValue:o.userPwCheck,"onUpdate:modelValue":a[3]||(a[3]=t=>o.userPwCheck=t),type:w.value?"text":"password",label:"사용자 비밀번호 확인",variant:"outlined",density:"compact","hide-details":"",disabled:r.value,"append-inner-icon":w.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":a[4]||(a[4]=t=>w.value=!w.value)},null,8,["modelValue","type","disabled","append-inner-icon"])]),_:1}),l(B,{class:"my-3"})],64)),l(i,{cols:"12"},{default:s(()=>[l($,{modelValue:o.casinoId,"onUpdate:modelValue":a[5]||(a[5]=t=>o.casinoId=t),items:_.value,"item-title":"casinoName","item-value":"casinoId",label:"소속 카지노",variant:"outlined",density:"compact","hide-details":""},{item:s(({props:t,item:J})=>[l(le,ae(t,{subtitle:J.raw.casinoId}),null,16,["subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),l(i,{cols:"12"},{default:s(()=>[l(f,{modelValue:o.userName,"onUpdate:modelValue":a[6]||(a[6]=t=>o.userName=t),label:"사용자 이름",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12"},{default:s(()=>[l(f,{modelValue:o.employeeId,"onUpdate:modelValue":a[7]||(a[7]=t=>o.employeeId=t),label:"사용자 사원 번호",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12"},{default:s(()=>[l($,{modelValue:o.userLevel,"onUpdate:modelValue":a[8]||(a[8]=t=>o.userLevel=t),items:k.value,"item-title":"title","item-value":"value",label:"권한",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items"])]),_:1}),l(B,{class:"my-3"}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.officeCode01,"onUpdate:modelValue":a[9]||(a[9]=t=>o.officeCode01=t),label:"사용자 소속 1",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.officeCode02,"onUpdate:modelValue":a[10]||(a[10]=t=>o.officeCode02=t),label:"사용자 소속 2",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.officeCode03,"onUpdate:modelValue":a[11]||(a[11]=t=>o.officeCode03=t),label:"사용자 소속 3",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.officeCode04,"onUpdate:modelValue":a[12]||(a[12]=t=>o.officeCode04=t),label:"사용자 소속 4",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(B,{class:"my-3"}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.tel01,"onUpdate:modelValue":a[13]||(a[13]=t=>o.tel01=t),label:"사용자 전화번호 1",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),l(i,{cols:"6"},{default:s(()=>[l(f,{modelValue:o.tel02,"onUpdate:modelValue":a[14]||(a[14]=t=>o.tel02=t),label:"사용자 전화번호 2",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(te,null,{default:s(()=>[l(H),l(N,{color:"error",onClick:L},{default:s(()=>[...a[17]||(a[17]=[x("취소",-1)])]),_:1}),l(N,{color:"primary",loading:P.value,onClick:c},{default:s(()=>[x(U(r.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},fe={class:"d-flex align-center ga-3 mb-2"},ve={class:"d-flex flex-column ga-1"},pe={class:"d-flex align-center"},me={class:"d-flex align-center"},Ve={class:"d-flex justify-end ga-1"},xe={__name:"index",setup(y){const b=u(!1),p=u([]),g=u(0),v=u(1),r=u(15),C=u([]),P=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],m=u(""),w=[{title:"No",key:"no",sortable:!1,width:100},{title:"사원번호",key:"employeeId",sortable:!1},{title:"이름",key:"userName",sortable:!1},{title:"권한",key:"userLevel",sortable:!1},{title:"소속 카지노",key:"casinoId",sortable:!1},{title:"소속 ①",key:"officeCode01",sortable:!1},{title:"소속 ②",key:"officeCode02",sortable:!1},{title:"소속 ③",key:"officeCode03",sortable:!1},{title:"소속 ④",key:"officeCode04",sortable:!1},{title:"전화번호",key:"tel01",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}],k=async()=>{b.value=!0;try{const d=await z.getPageMemberInfos({page:v.value-1,size:r.value,keyword:m.value||""});p.value=(d==null?void 0:d.content)??(d==null?void 0:d.items)??(d==null?void 0:d.list)??[],g.value=(d==null?void 0:d.totalElements)??(d==null?void 0:d.total)??0}finally{b.value=!1}},h=d=>{v.value=d.page,r.value=d.itemsPerPage,C.value=d.sortBy??[],k()};R(()=>{k()}),oe(m,()=>{v.value=1,k()},{debounce:350,maxWait:1200});const o=u(!1),I=u(null),S=d=>{I.value={...d},o.value=!0},L=()=>{I.value=null,o.value=!0},_=u(!1);return(d,c)=>(T(),A(W,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:s(()=>[l(ce,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=n=>o.value=n),"edit-item":I.value,onSave:k},null,8,["modelValue","edit-item"]),l(ne,{modelValue:_.value,"onUpdate:modelValue":c[1]||(c[1]=n=>_.value=n),message:"선택한 사용자를 삭제하시겠습니까?"},null,8,["modelValue"]),V("div",fe,[l(f,{modelValue:m.value,"onUpdate:modelValue":c[2]||(c[2]=n=>m.value=n),density:"compact",variant:"outlined","hide-details":"",placeholder:"사용자 검색 (ID, 이름)",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),l(H),l(N,{variant:"outlined",onClick:L,class:"bg-gold"},{default:s(()=>[...c[3]||(c[3]=[x(" 사용자 등록 ",-1)])]),_:1})]),l(re,{headers:w,items:p.value,"items-length":g.value,loading:b.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":r.value,page:v.value,"onUpdate:options":h,"items-per-page-options":P,class:"alarm-table"},{"item.no":s(({index:n})=>[x(U((v.value-1)*r.value+n+1),1)]),"item.userLevel":s(({item:n})=>[l(se,{size:"small",variant:"tonal",color:M(O)(n.userLevel).color,class:"font-weight-medium"},{default:s(()=>[l(D,{start:"",size:"16",icon:M(O)(n.userLevel).icon},null,8,["icon"]),x(" "+U(M(O)(n.userLevel).text),1)]),_:2},1032,["color"])]),"item.tel01":s(({item:n})=>[V("div",ve,[V("div",pe,[l(D,{icon:"mdi-phone",size:"16",class:"mr-1"}),V("span",null,U(n.tel01||"-"),1)]),V("div",me,[l(D,{icon:"mdi-phone-outline",size:"16",class:"mr-1"}),V("span",null,U(n.tel02||"-"),1)])])]),"item.actions":s(({item:n})=>[V("div",Ve,[l(N,{icon:"",variant:"text",size:"x-small",onClick:e=>S(n)},{default:s(()=>[l(D,{icon:"mdi-pencil"})]),_:1},8,["onClick"])])]),"no-data":s(()=>[...c[4]||(c[4]=[V("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{xe as default};
