import{a as E,J as n,a7 as O,a3 as R,S as T,O as w,L as o,n as l,R as B,aU as F,E as I,W as C,H as y,V as S,U as x,aV as L,P as $,K as j,T as z,Q as N,Y as A,aW as M,a6 as P,a2 as W,a4 as H}from"./index-BEfUtk8q.js";import{a as U}from"./alarmService-TrGqV6LZ.js";import{s as J}from"./Toast-Bj6FhXbI.js";import{V as K}from"./VForm-3zuL6ByH.js";import{V as Q,_ as Y}from"./ConfirmDialog-RxUvG1uJ.js";import{V as q}from"./VDataTableServer-Dekjmu6M.js";import"./VPagination-D01cRuXz.js";const G={key:0,class:"text-red text-caption"},X={__name:"AlarmSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(h,{emit:p}){const r=h,f=p,i=E({get:()=>r.modelValue,set:e=>f("update:modelValue",e)}),u=E(()=>!!r.editItem),c=n(null),v=n(!1),s=O({...{idxNo:null,alarmId:"",alarmDesc:""}});function m(){var e,a;s.idxNo=null,s.alarmId="",s.alarmDesc="",(a=(e=c.value)==null?void 0:e.resetValidation)==null||a.call(e)}function _(e){var a,t;s.idxNo=(e==null?void 0:e.idxNo)??null,s.alarmId=(e==null?void 0:e.alarmId)??"",s.alarmDesc=(e==null?void 0:e.alarmDesc)??"",(t=(a=c.value)==null?void 0:a.resetValidation)==null||t.call(a)}const d=()=>{i.value=!1};R(()=>i.value,e=>{if(!e){m();return}r.editItem?_(r.editItem):m()});const g=async()=>{var t;const{valid:e}=await((t=c.value)==null?void 0:t.validate());!e||!await b()||(f("save"),d())},b=async()=>{try{return v.value=!0,u.value?await U.updateAlarm(s.idxNo,s):await U.saveAlarm(s),!0}catch(e){return J((e==null?void 0:e.message)||"알람정보 변경에 실패했습니다."),!1}finally{v.value=!1}},k=[e=>!!e||"알람 ID는 필수입니다.",e=>(e==null?void 0:e.length)<=10||"알람 ID는 최대 10자까지 입력 가능합니다."],D=[e=>(e==null?void 0:e.length)<=50||"알람 설명은 최대 50자까지 입력 가능합니다."];return(e,a)=>(w(),T(Q,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=t=>i.value=t),persistent:"","max-width":"450"},{default:o(()=>[l(B,null,{default:o(()=>[l(F,{class:"d-flex justify-space-between align-center"},{default:o(()=>[I("span",null,C(u.value?"알람 수정":"알람 등록"),1),l(y,{icon:"",variant:"text",onClick:d},{default:o(()=>[l(S,null,{default:o(()=>[...a[3]||(a[3]=[x("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),l(L,{class:"pt-0"},{default:o(()=>[l(K,{ref_key:"form",ref:c},{default:o(()=>[l($,{dense:""},{default:o(()=>[u.value?z("",!0):(w(),j("span",G,"* 알람 ID 는 등록 후 수정이 불가능 합니다.")),l(N,{cols:"12"},{default:o(()=>[l(A,{modelValue:s.alarmId,"onUpdate:modelValue":a[0]||(a[0]=t=>s.alarmId=t),label:"알람 ID",variant:"outlined",density:"compact",rules:k,disabled:u.value},null,8,["modelValue","disabled"])]),_:1}),l(N,{cols:"12"},{default:o(()=>[l(A,{modelValue:s.alarmDesc,"onUpdate:modelValue":a[1]||(a[1]=t=>s.alarmDesc=t),label:"알람 설명",variant:"outlined",density:"compact",rules:D},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(M,null,{default:o(()=>[l(P),l(y,{color:"error",onClick:d},{default:o(()=>[...a[4]||(a[4]=[x("취소",-1)])]),_:1}),l(y,{color:"primary",loading:v.value,onClick:g},{default:o(()=>[x(C(u.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Z={class:"d-flex align-center ga-3 mb-2"},ee={class:"d-flex justify-end ga-1"},de={__name:"index",setup(h){const p=n(!1),r=n([]),f=n(0),i=n(1),u=n(15),c=n([]),v=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],V=n(""),s=[{title:"No",key:"no",sortable:!1,width:100},{title:"알람 ID",key:"alarmId",sortable:!1,width:300},{title:"설명",key:"alarmDesc",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}];async function m(){p.value=!0;try{const e=await U.getPageAlarmInfos({page:i.value-1,size:u.value,alarmId:V.value||""});r.value=(e==null?void 0:e.content)??(e==null?void 0:e.items)??(e==null?void 0:e.list)??[],f.value=(e==null?void 0:e.totalElements)??(e==null?void 0:e.total)??0}finally{p.value=!1}}function _(e){i.value=e.page,u.value=e.itemsPerPage,c.value=e.sortBy??[],m()}W(()=>{m()}),H(V,()=>{i.value=1,m()},{debounce:350,maxWait:1200});const d=n(!1),g=n(null);function b(e){g.value={...e},d.value=!0}function k(){g.value=null,d.value=!0}const D=n(!1);return(e,a)=>(w(),T(B,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:o(()=>[l(X,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),"edit-item":g.value,onSave:m},null,8,["modelValue","edit-item"]),l(Y,{modelValue:D.value,"onUpdate:modelValue":a[1]||(a[1]=t=>D.value=t),message:"선택한 알람을 삭제하시겠습니까?"},null,8,["modelValue"]),I("div",Z,[l(A,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=t=>V.value=t),density:"compact",variant:"outlined","hide-details":"",placeholder:"알람 ID 검색",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),l(P),l(y,{variant:"outlined",onClick:k,class:"bg-gold"},{default:o(()=>[...a[3]||(a[3]=[x(" 알람 등록 ",-1)])]),_:1})]),l(q,{headers:s,items:r.value,"items-length":f.value,loading:p.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":u.value,page:i.value,"onUpdate:options":_,"items-per-page-options":v,class:"alarm-table"},{"item.no":o(({index:t})=>[x(C((i.value-1)*u.value+t+1),1)]),"item.actions":o(({item:t})=>[I("div",ee,[l(y,{icon:"",variant:"text",size:"x-small",onClick:ae=>b(t)},{default:o(()=>[l(S,{icon:"mdi-pencil"})]),_:1},8,["onClick"])])]),"no-data":o(()=>[...a[4]||(a[4]=[I("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{de as default};
