import{a as B,J as i,a7 as M,a2 as O,a3 as $,S as F,O as h,L as o,n as a,R,aU as j,E as k,W as N,H as b,V as Y,U as V,aV as L,P as W,K as H,T as J,Q as U,Y as E,Z as K,aW as Q,a6 as z,a4 as Z,aR as q,ae as G}from"./index-Db0vexY2.js";import{g as S}from"./gameService-C_phNESk.js";import{i as X}from"./iconService-pa2jy4zs.js";import{s as A}from"./Toast-CP6CXrnL.js";import{V as ee}from"./VForm-DZERiIuS.js";import{V as ae,_ as le}from"./ConfirmDialog-GWLvpLjZ.js";import{g as P}from"./uiMeta-B6m7eSIp.js";import{V as te}from"./VDataTableServer-BSjrfDhu.js";import"./VPagination-BNAUXgdD.js";const oe={key:0,class:"text-red text-caption"},se={__name:"GameSaveDialog",props:{modelValue:Boolean,editItem:{type:Object,default:null}},emits:["update:modelValue","save"],setup(T,{emit:y}){const c=T,I=y,u=B({get:()=>c.modelValue,set:e=>I("update:modelValue",e)}),m=B(()=>!!c.editItem),p=i(null),x=i(!1),s=M({...{idxNo:null,gameId:"",gameName:"",iconId:null}}),v=()=>{var e,t;s.idxNo=null,s.gameId="",s.gameName="",s.iconId=null,(t=(e=p.value)==null?void 0:e.resetValidation)==null||t.call(e)},w=e=>{var t,n;s.idxNo=(e==null?void 0:e.idxNo)??null,s.gameId=(e==null?void 0:e.gameId)??"",s.gameName=(e==null?void 0:e.gameName)??"",s.iconId=(e==null?void 0:e.iconId)??null,(n=(t=p.value)==null?void 0:t.resetValidation)==null||n.call(t)},r=()=>{u.value=!1},g=i([]),D=async()=>{try{const e=await X.getAllIcons();g.value=e}catch(e){A(e.message||"아이콘 조회중 오류가 발생하였습니다.")}};O(()=>D()),$(()=>u.value,e=>{if(!e){v();return}c.editItem?w(c.editItem):v()});const C=async()=>{var n;const{valid:e}=await((n=p.value)==null?void 0:n.validate());!e||!await _()||(I("save"),r())},_=async()=>{try{return x.value=!0,m.value?await S.updateGame(s.idxNo,s):await S.saveGame(s),!0}catch(e){return A((e==null?void 0:e.message)||"게임정보 변경에 실패했습니다."),!1}finally{x.value=!1}},l=[e=>!!e||"게임 ID는 필수입니다.",e=>(e==null?void 0:e.length)<=10||"게임 ID는 최대 10자까지 입력 가능합니다."],d=[e=>!!e||"게임 이름은 필수입니다.",e=>(e==null?void 0:e.length)<=50||"게임 이름은 최대 50자까지 입력 가능합니다."];return(e,t)=>(h(),F(ae,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=n=>u.value=n),persistent:"","max-width":"450"},{default:o(()=>[a(R,null,{default:o(()=>[a(j,{class:"d-flex justify-space-between align-center"},{default:o(()=>[k("span",null,N(m.value?"게임 수정":"게임 등록"),1),a(b,{icon:"",variant:"text",onClick:r},{default:o(()=>[a(Y,null,{default:o(()=>[...t[4]||(t[4]=[V("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),a(L,{class:"pt-0"},{default:o(()=>[a(ee,{ref_key:"form",ref:p},{default:o(()=>[a(W,{dense:""},{default:o(()=>[m.value?J("",!0):(h(),H("span",oe,"* 게임 ID 는 등록 후 수정이 불가능 합니다.")),a(U,{cols:"12"},{default:o(()=>[a(E,{modelValue:s.gameId,"onUpdate:modelValue":t[0]||(t[0]=n=>s.gameId=n),label:"게임 ID",variant:"outlined",density:"compact",rules:l,disabled:m.value},null,8,["modelValue","disabled"])]),_:1}),a(U,{cols:"12"},{default:o(()=>[a(E,{modelValue:s.gameName,"onUpdate:modelValue":t[1]||(t[1]=n=>s.gameName=n),label:"게임 이름",variant:"outlined",density:"compact",rules:d},null,8,["modelValue"])]),_:1}),a(U,{cols:"12"},{default:o(()=>[a(K,{modelValue:s.iconId,"onUpdate:modelValue":t[2]||(t[2]=n=>s.iconId=n),items:g.value,"item-title":"iconName","item-value":"iconId",label:"게임 아이콘",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(Q,null,{default:o(()=>[a(z),a(b,{color:"error",onClick:r},{default:o(()=>[...t[5]||(t[5]=[V("취소",-1)])]),_:1}),a(b,{color:"primary",loading:x.value,onClick:C},{default:o(()=>[V(N(m.value?"수정":"등록"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ne={class:"d-flex align-center ga-3 mb-2"},ie={class:"d-flex justify-end ga-1"},Ve={__name:"index",setup(T){const y=i(!1),c=i([]),I=i(0),u=i(1),m=i(15),p=i([]),x=[{title:"10",value:10},{title:"15",value:15},{title:"30",value:30},{title:"50",value:50}],f=i(""),s=[{title:"No",key:"no",sortable:!1,width:100},{title:"게임 ID",key:"gameId",sortable:!1,width:300},{title:"게임 이름",key:"gameName",sortable:!1},{title:"아이콘 ID",key:"iconId",sortable:!1},{title:"사용여부",key:"useYn",sortable:!1},{title:"관리",key:"actions",sortable:!1,width:110,align:"center"}],v=async()=>{y.value=!0;try{const l=await S.getPageGameInfos({page:u.value-1,size:m.value,gameId:f.value||"",gameName:f.value||""});c.value=(l==null?void 0:l.content)??(l==null?void 0:l.items)??(l==null?void 0:l.list)??[],I.value=(l==null?void 0:l.totalElements)??(l==null?void 0:l.total)??0}finally{y.value=!1}},w=l=>{u.value=l.page,m.value=l.itemsPerPage,p.value=l.sortBy??[],v()};O(()=>{v()}),Z(f,()=>{u.value=1,v()},{debounce:350,maxWait:1200});const r=i(!1),g=i(null),D=l=>{g.value={...l},r.value=!0},C=()=>{g.value=null,r.value=!0},_=i(!1);return(l,d)=>(h(),F(R,{variant:"outlined",height:"680",class:"pa-2",style:{"border-color":"rgba(180, 180, 181, 0.6)"}},{default:o(()=>[a(se,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=e=>r.value=e),"edit-item":g.value,onSave:v},null,8,["modelValue","edit-item"]),a(le,{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=e=>_.value=e),message:"선택한 게임을 삭제하시겠습니까?"},null,8,["modelValue"]),k("div",ne,[a(E,{modelValue:f.value,"onUpdate:modelValue":d[2]||(d[2]=e=>f.value=e),density:"compact",variant:"outlined","hide-details":"",placeholder:"게임 검색 (ID, 이름)",style:{"max-width":"260px"},clearable:""},null,8,["modelValue"]),a(z),a(b,{variant:"outlined",onClick:C,class:"bg-gold"},{default:o(()=>[...d[3]||(d[3]=[V(" 게임 등록 ",-1)])]),_:1})]),a(te,{headers:s,items:c.value,"items-length":I.value,loading:y.value,"item-value":"alarmId",density:"compact","fixed-header":"",height:"560","items-per-page":m.value,page:u.value,"onUpdate:options":w,"items-per-page-options":x,class:"alarm-table"},{"item.no":o(({index:e})=>[V(N((u.value-1)*m.value+e+1),1)]),"item.useYn":o(({item:e})=>[a(q,{size:"small",variant:"flat",color:G(P)(e.useYn).color,class:"font-weight-medium"},{default:o(()=>[V(N(G(P)(e.useYn).text),1)]),_:2},1032,["color"])]),"item.actions":o(({item:e})=>[k("div",ie,[a(b,{icon:"",variant:"text",size:"x-small",onClick:t=>D(e)},{default:o(()=>[a(Y,{icon:"mdi-pencil"})]),_:1},8,["onClick"])])]),"no-data":o(()=>[...d[4]||(d[4]=[k("div",{class:"py-10 text-medium-emphasis"},"데이터가 없습니다.",-1)])]),_:1},8,["items","items-length","loading","items-per-page","page"])]),_:1}))}};export{Ve as default};
